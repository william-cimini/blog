<!DOCTYPE html>
<html>
<head>
  <meta content="text/html; charset=utf-8" http-equiv="content-type">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>William Cimini's Blog</title>
  <link href='normalize.css' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
</head>
<body>
  <header>
    <nav>
        <a href="/">williamcimini.com</a>
    </nav>
  </header>
<main>
<h1 id="fast-and-easy-way-to-create-gui-components-in-powershell">Fast and easy way to create GUI components in PowerShell</h1>
<h2 id="cause">Cause</h2>
<ul>
<li>Graphical interfaces are more accessible then console commands and text interfaces</li>
<li>PowerShell offers the Windows Forms API to create GUI objects.</li>
<li>Creating GUI objects in the typical fashion is laborious, hard to read, and error prone.</li>
<li>The management of such code is difficult due to the above effects, especially if you need extend, change, or remove functionality.</li>
<li>This effect is exponential depending on how many GUI objects you manage at once.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">$Report</span> <span class="op">=</span> <span class="fu">Get-Process</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>System<span class="op">.</span><span class="fu">Reflection</span><span class="op">.</span><span class="fu">Assembly</span><span class="op">]::</span>LoadWithPartialName<span class="op">(</span><span class="st">&quot;System.Windows.Forms&quot;</span><span class="op">)</span> <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="va">$SaveReportFileDialog</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">.</span><span class="fu">SaveFileDialog</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="va">$SaveReportFileDialog</span><span class="op">.</span><span class="fu">InitialDirectory</span> <span class="op">=</span> <span class="st">&quot;$($Env:USERPROFILE)\Downloads&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="va">$SaveReportFileDialog</span><span class="op">.</span><span class="fu">FileName</span> <span class="op">=</span> <span class="st">&quot;Report.txt&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="va">$SaveReportFileDialog</span><span class="op">.</span><span class="fu">Filter</span> <span class="op">=</span> “All files <span class="op">(*.*)|</span> <span class="op">*.*</span>”</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="va">$SaveReportFileDialog</span><span class="op">.</span><span class="fu">ShowDialog</span><span class="op">()</span> <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="va">$SaveReportPath</span> <span class="op">=</span> <span class="va">$SaveReportFileDialog</span><span class="op">.</span><span class="fu">FileName</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="va">$Report</span> <span class="op">|</span> <span class="fu">Export-CSV</span> <span class="op">-</span>Delimiter <span class="st">&quot;</span><span class="ch">`t</span><span class="st">&quot;</span> <span class="op">-</span>Path <span class="va">$SaveReportPath</span> <span class="op">-</span>NoTypeInformation</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="va">$UserResponse</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">.</span><span class="fu">MessageBox</span><span class="op">]::</span>Show<span class="op">(</span><span class="st">&quot;Report saved, would you like to open it in Excel?&quot;</span><span class="op">,</span> <span class="st">&quot;&quot;</span><span class="op">,</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">.</span><span class="fu">MessageBoxButtons</span><span class="op">]::</span>YesNoCancel<span class="op">,</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">.</span><span class="fu">MessageBoxIcon</span><span class="op">]::</span>Question<span class="op">)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="op">(</span><span class="va">$UserResponse</span> <span class="op">-</span>eq <span class="st">&quot;Yes&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Start-Process</span> excel<span class="op">.</span><span class="fu">exe</span> <span class="op">-</span>ArgumentList <span class="va">$SaveReportPath</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="solution">Solution</h2>
<ul>
<li>Hide the implementation of WinForms components in easy to use, readable, and reusable functions.</li>
</ul>
<h2 id="technical-details">Technical Details</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Show<span class="op">-</span>MessageBox <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span><span class="op">(</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Text</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">,</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Caption</span> <span class="op">=</span> $<span class="op">(</span><span class="kw">if</span> <span class="op">(</span><span class="va">$ScriptName</span> <span class="op">=</span> <span class="op">(</span><span class="va">$MyInvocation</span><span class="op">.</span><span class="fu">ScriptName</span><span class="op">))</span> <span class="op">{</span> <span class="va">$ScriptName</span> <span class="op">|</span> <span class="fu">Split-Path</span> <span class="op">-</span>Leaf <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="va">$MyInvocation</span><span class="op">.</span><span class="fu">MyCommand</span><span class="op">.</span><span class="fu">Name</span> <span class="op">}</span> <span class="op">),</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>ValidateSet<span class="op">(</span><span class="st">&quot;OK&quot;</span><span class="op">,</span><span class="st">&quot;OKCancel&quot;</span><span class="op">,</span><span class="st">&quot;AbortRetryIgnore&quot;</span><span class="op">,</span><span class="st">&quot;YesNoCancel&quot;</span><span class="op">,</span><span class="st">&quot;YesNo&quot;</span><span class="op">,</span><span class="st">&quot;RetryCancel&quot;</span><span class="op">)]</span><span class="va">$Button</span> <span class="op">=</span> <span class="st">&quot;Ok&quot;</span><span class="op">,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>ValidateSet<span class="op">(</span><span class="st">&quot;None&quot;</span><span class="op">,</span><span class="st">&quot;Hand&quot;</span><span class="op">,</span><span class="st">&quot;Error&quot;</span><span class="op">,</span><span class="st">&quot;Stop&quot;</span><span class="op">,</span><span class="st">&quot;Question&quot;</span><span class="op">,</span><span class="st">&quot;Exclamation&quot;</span><span class="op">,</span><span class="st">&quot;Warning&quot;</span><span class="op">,</span><span class="st">&quot;Asterisk&quot;</span><span class="op">,</span><span class="st">&quot;Information&quot;</span><span class="op">)]</span><span class="va">$Icon</span> <span class="op">=</span> <span class="st">&quot;None&quot;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>System<span class="op">.</span><span class="fu">Reflection</span><span class="op">.</span><span class="fu">Assembly</span><span class="op">]::</span>LoadWithPartialName<span class="op">(</span><span class="st">&quot;System.Windows.Forms&quot;</span><span class="op">)</span> <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">.</span><span class="fu">MessageBox</span><span class="op">]::</span>Show<span class="op">(</span><span class="va">$Text</span><span class="op">,</span> <span class="va">$Caption</span><span class="op">,</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">.</span><span class="fu">MessageBoxButtons</span><span class="op">]::</span><span class="va">$Button</span><span class="op">,</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">.</span><span class="fu">MessageBoxIcon</span><span class="op">]::</span><span class="va">$Icon</span><span class="op">)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> Get<span class="op">-</span>FilePathViaDialog <span class="op">{</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">param</span><span class="op">(</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span>ValidateSet<span class="op">(</span><span class="st">&quot;Open&quot;</span><span class="op">,</span><span class="st">&quot;Save&quot;</span><span class="op">)]</span><span class="va">$Type</span> <span class="op">=</span> <span class="st">&quot;Open&quot;</span><span class="op">,</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">$InitialDirectory</span> <span class="op">=</span> <span class="va">$Env</span><span class="op">:</span>USERPROFILE<span class="op">,</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">$FileName</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">,</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">$Filter</span> <span class="op">=</span> “All files <span class="op">(*.*)|</span> <span class="op">*.*</span>”<span class="op">,</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">[</span><span class="kw">Switch</span><span class="op">]</span><span class="va">$Multiselect</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>System<span class="op">.</span><span class="fu">Reflection</span><span class="op">.</span><span class="fu">Assembly</span><span class="op">]::</span>LoadWithPartialName<span class="op">(</span>“System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span>”<span class="op">)</span> <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="va">$FileDialog</span> <span class="op">=</span> <span class="fu">New-Object</span> System<span class="op">.</span><span class="fu">Windows</span><span class="op">.</span><span class="fu">Forms</span><span class="op">.</span>$<span class="op">(</span><span class="va">$Type</span><span class="op">)</span>FileDialog <span class="op">-</span>Property @<span class="op">{</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        InitialDirectory <span class="op">=</span> <span class="va">$InitialDirectory</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        FileName <span class="op">=</span> <span class="va">$FileName</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">Filter</span> <span class="op">=</span> <span class="va">$Filter</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="op">(</span><span class="va">$Type</span> <span class="op">-</span>eq <span class="st">&quot;Open&quot;</span> <span class="op">-</span>and <span class="va">$Multiselect</span><span class="op">)</span> <span class="op">{</span> <span class="va">$FileDialog</span><span class="op">.</span><span class="fu">Multiselect</span> <span class="op">=</span> <span class="va">$True</span> <span class="op">}</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="va">$FileDialog</span><span class="op">.</span><span class="fu">ShowDialog</span><span class="op">()</span> <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="va">$FileDialog</span><span class="op">.</span><span class="fu">Filenames</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="example">Example</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="va">$GetProcessReport</span> <span class="op">=</span> <span class="fu">Get-Process</span> <span class="op">|</span> <span class="fu">Select-Object</span> <span class="op">-</span>First 20 </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="va">$ReportPath</span> <span class="op">=</span> Get<span class="op">-</span>FilePathViaDialog <span class="op">-</span>Type <span class="st">&quot;Save&quot;</span> <span class="op">-</span>FileName <span class="st">&quot;Report.txt&quot;</span> <span class="op">-</span>InitialDirectory <span class="st">&quot;$($Env:USERPROFILE)\Downloads&quot;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="va">$GetProcessReport</span> <span class="op">|</span> <span class="fu">Export-CSV</span> <span class="op">-</span>Delimiter <span class="st">&quot;</span><span class="ch">`t</span><span class="st">&quot;</span> <span class="op">-</span>Path <span class="va">$ReportPath</span> <span class="op">-</span>NoTypeInformation</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="op">(</span><span class="st">&quot;Yes&quot;</span> <span class="op">-</span>eq <span class="op">(</span>Show<span class="op">-</span>MessageBox <span class="op">-</span>Text <span class="st">&quot;Report saved, would you like to open it in Excel?&quot;</span> <span class="op">-</span>Button YesNoCancel <span class="op">-</span>Icon Question<span class="op">))</span> <span class="op">{</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Start-Process</span> excel<span class="op">.</span><span class="fu">exe</span> <span class="op">-</span>ArgumentList <span class="va">$ReportPath</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><img src="./attachments/SaveAsDialog.PNG" /></p>
<p><img src="./attachments/ConfirmSaveAs.PNG" /></p>
<p><img src="./attachments/Show-MessageBox.PNG" /></p>
</body>
</html>